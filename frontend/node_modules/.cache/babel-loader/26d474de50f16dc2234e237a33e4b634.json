{"ast":null,"code":"import _regeneratorRuntime from\"/home/leo/srv/recommender/frontend/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/leo/srv/recommender/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/leo/srv/recommender/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import ReactDOM from'react-dom';import axios from'axios';var books=[{Title:'The Republic'},{Title:'Candide'},{Title:'Beyond Good & Evil'},{Title:'Crime & Punishment'},{Title:'Gulag Archipelago'}];function Recommender(){var _useState=useState(books),_useState2=_slicedToArray(_useState,2),recommendations=_useState2[0],setRecommendations=_useState2[1];var onLogin=function onLogin(recommendations){console.log(recommendations);console.log(recommendations[0]);setRecommendations(recommendations[0]);};return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"hr\",null),/*#__PURE__*/React.createElement(Credentials,{onLogin:onLogin}),/*#__PURE__*/React.createElement(\"hr\",null),/*#__PURE__*/React.createElement(BookList,{books:recommendations}));}function Credentials(props){var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),username=_useState4[0],setUsername=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isLogged=_useState6[0],setIsLogged=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isLoading=_useState8[0],setIsLoading=_useState8[1];var handleLogin=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){var usr,pwd,postobj,reply,arr;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:event.preventDefault();console.log(event.target);usr=event.target.parentElement.parentElement.usr.value;pwd=event.target.parentElement.parentElement.pwd.value;postobj={usr:usr,pwd:pwd};_context.prev=5;setIsLoading(true);_context.next=9;return axios.post('login.php',postobj);case 9:reply=_context.sent;arr=reply.data;// authentication success\nsetIsLogged(true);setUsername(usr);// check if user has personalized recommendations\nif(!(arr.length==0)){_context.next=15;break;}throw'No Ratings!';case 15:props.onLogin(arr);_context.next=21;break;case 18:_context.prev=18;_context.t0=_context[\"catch\"](5);// authentication failure\nconsole.log(_context.t0);case 21:_context.prev=21;setIsLoading(false);return _context.finish(21);case 24:case\"end\":return _context.stop();}}},_callee,null,[[5,18,21,24]]);}));return function handleLogin(_x){return _ref.apply(this,arguments);};}();var handleRegister=function handleRegister(event){event.preventDefault();console.log(event.target.parentElement.usr.value);};var html;if(!isLogged){html=/*#__PURE__*/React.createElement(\"form\",{method:\"POST\"},/*#__PURE__*/React.createElement(\"fieldset\",{disabled:isLoading},/*#__PURE__*/React.createElement(\"input\",{type:\"text\",name:\"usr\",placeholder:\"Username\",autocomplete:\"off\"}),/*#__PURE__*/React.createElement(\"input\",{type:\"password\",name:\"pwd\",placeholder:\"Password\",autocomplete:\"off\"}),/*#__PURE__*/React.createElement(\"button\",{type:\"submit\",onClick:handleLogin},\"Login\"),/*#__PURE__*/React.createElement(\"button\",{type:\"submit\",onClick:handleRegister},\"Register\")));}else{html=/*#__PURE__*/React.createElement(\"fieldset\",null,/*#__PURE__*/React.createElement(\"div\",null,\"Logged In as \",username));}return html;}function BookList(props){var books=props.books;var listItems=books.map(function(book){var image=new Image();image.src='https://images-na.ssl-images-amazon.com/images/I/41DxTj1cWoL._SX316_BO1,204,203,200_.jpg';var h=image.height;var w=image.width;return/*#__PURE__*/React.createElement(\"div\",{class:\"col-lg-2\"},book.Title,/*#__PURE__*/React.createElement(\"img\",{alt:\"cover_image\",src:\"https://images-na.ssl-images-amazon.com/images/I/41DxTj1cWoL._SX316_BO1,204,203,200_.jpg\"}),h,\" x \",w);});return/*#__PURE__*/React.createElement(\"div\",{class:\"row m-3\"},listItems);}ReactDOM.render(/*#__PURE__*/React.createElement(Recommender,null),document.getElementById('root'));","map":{"version":3,"sources":["/home/leo/srv/recommender/frontend/src/index.js"],"names":["React","useState","useEffect","ReactDOM","axios","books","Title","Recommender","recommendations","setRecommendations","onLogin","console","log","Credentials","props","username","setUsername","isLogged","setIsLogged","isLoading","setIsLoading","handleLogin","event","preventDefault","target","usr","parentElement","value","pwd","postobj","post","reply","arr","data","length","handleRegister","html","BookList","listItems","map","book","image","Image","src","h","height","w","width","render","document","getElementById"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport ReactDOM from 'react-dom';\nimport axios from 'axios';\n\nconst books = [{Title: 'The Republic'}, {Title: 'Candide'}, {Title:'Beyond Good & Evil'}, {Title:'Crime & Punishment'}, {Title:'Gulag Archipelago'}];\n\nfunction Recommender() {\n  const [recommendations, setRecommendations] = useState(books);\n\n  const onLogin = (recommendations) => {\n    console.log(recommendations);\n    console.log(recommendations[0]);\n    setRecommendations(recommendations[0]);\n\n  }\n\n  return(\n    <div>\n      <hr/>\n      <Credentials onLogin={onLogin}/>\n      <hr/>\n      <BookList books={recommendations} />\n      {/* <BookList books={recommendations} />\n      <BookList books={recommendations} />\n      <BookList books={recommendations} />\n      <BookList books={recommendations} />\n      <BookList books={recommendations} /> */}\n    </div>\n  );\n}\n\nfunction Credentials(props) {\n  const [username, setUsername] = useState(null);\n  const [isLogged, setIsLogged] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n\n  const handleLogin = async(event) => {\n    event.preventDefault();\n    console.log(event.target);\n    let usr = event.target.parentElement.parentElement.usr.value;\n    let pwd = event.target.parentElement.parentElement.pwd.value;\n\n    const postobj = {usr: usr, pwd: pwd};\n    try {\n      setIsLoading(true);\n      let reply = await axios.post('login.php', postobj);\n      let arr = reply.data;\n\n      // authentication success\n      setIsLogged(true);\n      setUsername(usr);\n\n      // check if user has personalized recommendations\n      if(arr.length == 0)\n        throw 'No Ratings!';\n      props.onLogin(arr)\n    } catch(e) {\n      // authentication failure\n      console.log(e);\n    } finally {\n      setIsLoading(false);\n    }\n  }\n\n  const handleRegister = event => {\n    event.preventDefault();\n    console.log(event.target.parentElement.usr.value);\n\n  }\n  \n  var html;\n  if(!isLogged) {\n      html =\n      <form method=\"POST\">\n      <fieldset disabled={isLoading}>\n        <input type=\"text\" name=\"usr\" placeholder=\"Username\" autocomplete=\"off\"></input>\n        <input type=\"password\" name=\"pwd\" placeholder=\"Password\" autocomplete=\"off\"></input>\n        <button type=\"submit\" onClick={handleLogin}>Login</button>  \n        <button type=\"submit\" onClick={handleRegister}>Register</button>\n      </fieldset>\n      </form>;\n  } else {\n      html = <fieldset><div>Logged In as {username}</div></fieldset>\n  }\n  return html;\n}\n\nfunction BookList(props) {\n  const books = props.books;\n  const listItems = books.map((book) => {\n    let image = new Image();\n    image.src = 'https://images-na.ssl-images-amazon.com/images/I/41DxTj1cWoL._SX316_BO1,204,203,200_.jpg'\n    let h = image.height;\n    let w = image.width;\n\n    return (\n    <div class='col-lg-2'>\n      {book.Title}\n      <img alt='cover_image' src='https://images-na.ssl-images-amazon.com/images/I/41DxTj1cWoL._SX316_BO1,204,203,200_.jpg'/>\n      {h} x {w}\n    </div>\n    );\n  });\n\n  return(\n    <div class='row m-3'>{listItems}</div>\n  );\n}\n\nReactDOM.render(<Recommender/>, document.getElementById('root'));"]},"metadata":{},"sourceType":"module"}